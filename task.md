# Xisp 任务清单

> 仓颉嵌入式 Lisp 脚本语言 - 开发进度管理

---

## 📊 总体进度

- ✅ M1: 核心 Lisp 解释器 (MVP)
- ✅ M2: 仓颉互操作桥接
- ✅ M3: 现代化语法扩展
- ✅ M3.5: 模块系统基础
- 🚧 M4: 高级特性和完善

---

## M1: 核心 Lisp 解释器 (MVP) ✅

- [x] 解析和求值 S-表达式
- [x] 核心特殊形式（define, lambda, if, quote, let）
- [x] 闭包和词法作用域
- [x] REPL 交互
- [x] 核心测试套件（183个测试全部通过）

**完成时间**: 2026-01-21

---

## M2: 仓颉互操作桥接 ✅

- [x] Lisp → 仓颉函数调用
- [ ] 仓颉 → Lisp 函数调用
- [x] std.io 桥接
- [x] std.fs 桥接
- [x] LispInterpreter API
- [x] 桥接层文档

**完成时间**: 2026-01-22

---

## M3: 现代化语法扩展 ✅

- [x] 解构绑定
- [x] 管道操作符 (->)
- [x] 向量字面量 []
- [x] 哈希映射字面量 {}
- [x] 哈希集合字面量 #{}
- [x] 字符串插值 #"{}"
- [x] 高阶函数 (map/filter/reduce)

**完成时间**: 2026-01-22

---

## M3.5: 模块系统 ✅

- [x] 模块命名空间 (组织名::包名)
- [x] 模块元数据 (module.lisp)
- [x] 模块加载和注册
- [x] 依赖解析
- [x] 相对路径导入 (./local.lisp)
- [x] 绝对路径导入 (org::module)
- [x] 符号导出 (export)
- [x] 模块系统测试（183个测试通过）

**完成时间**: 2026-01-24

---

## M4: 高级特性和完善 🚧

### 4.1 文件和脚本支持
- [ ] evalFile 实现
- [ ] CLI 脚本运行参数
- [ ] shebang 支持

### 4.2 模块系统增强
- [ ] 标准库路径 (std.xxx)
- [ ] 版本范围语法 (^, ~, >=, <=)

> 注：以下功能已实现或不需要
> ✅ module.lisp 元数据（替代 define-module）
> ✅ 搜索路径 XISP_PATH（替代 *module-path*）
> ✅ 用户库路径 ~/.xisp/modules/

### 4.3 标准库
- [ ] std.collection 模块
  - [ ] 集合桥接函数
  - [ ] 列表操作函数
- [ ] std.string 扩展
- [ ] std.math 基础函数

### 4.4 宏系统增强
- [ ] 宏展开调试工具
- [ ] 宏卫生性检查
- [ ] compile-time 计算

### 4.5 错误处理和调试
- [ ] 错误类型系统
- [ ] 调用栈追踪
- [ ] 调试器 (debugger)
- [ ] 性能分析

### 4.6 文档和工具
- [ ] API 文档生成
- [ ] 包管理器 (cjlpm)
- [ ] 测试覆盖率报告
- [ ] REPL 增强功能

---

## 📝 待修复问题

### 高优先级
- [ ] 无

### 中优先级
- [ ] 无

### 低优先级
- [ ] 仓颉反向调用 Lisp 函数

---

## 🔧 代码 TODO

- [ ] src/interpreter.cj:192 - std.collection 模块注册
- [ ] src/interpreter.cj:607 - evalFile 文件读取
- [ ] src/options.cj:141 - 集合函数实现
- [ ] src/core/dependency_resolver.cj:408 - 版本范围语法

---

## 📅 更新记录

- 2026-01-24: 模块系统基础完成，相对导入修复
- 2026-01-23: 模块系统测试全部通过
- 2026-01-22: 现代化语法和桥接层完成
- 2026-01-21: 核心 MVP 完成
