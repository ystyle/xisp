; Xisp 中文编程演示
; 这个文件展示了如何在 Xisp 中使用中文进行编程
;
; ⚠️ 重要提示：
; 1. 启动 Xisp 后，输入 ",lang zh" 启用中文关键字
; 2. 或者修改 src/main.cj，取消注释 withChineseKeywords()
; 3. 本示例使用完整中文关键字（需要在 REPL 中先输入 ,lang zh）

; ================================
; 步骤 0：启用中文关键字（REPL 中执行）
; ================================
; ,lang zh

; ================================
; 基础变量定义
; ================================

(定义 年龄 25)
(定义 姓名 "张三")
(定义 城市 "北京")

(打印 "姓名：" 姓名)
(打印 "年龄：" 年龄)
(打印 "城市：" 城市)

; ================================
; 中文函数定义
; ================================

; 定义计算圆面积的函数
(定义 计算圆面积
  (过程 (半径)
    (* 3.14159 半径 半径)))

; 定义求和函数
(定义 求和
  (过程 (数值列表)
    (apply + 数值列表)))

; 定义平均值函数
(定义 计算平均值
  (过程 (数值列表)
    (/ (求和 数值列表) (length 数值列表))))

; ================================
; 函数调用示例
; ================================

(打印 "\n=== 圆面积计算 ===")
(定义 圆半径 5.0)
(定义 面积 (计算圆面积 圆半径))
(打印 "半径：" 圆半径)
(打印 "面积：" 面积)

(打印 "\n=== 统计计算 ===")
(定义 成绩 '(85 90 78 92 88))
(打印 "成绩列表：" 成绩)
(打印 "总分：" (求和 成绩))
(打印 "平均分：" (计算平均值 成绩))

; ================================
; 中文解构绑定
; ================================

(打印 "\n=== 解构绑定示例 ===")

; 绑定首元素和剩余部分
(让 ((首 . 其余) '(1 2 3 4 5))
  (打印 "第一个元素：" 首)
  (打印 "剩余元素：" 其余))

; 嵌套解构
(让 (((第一 . 第二) . 第三) '((10 20) 30 40))
  (打印 "第一个：" 第一)
  (打印 "第二个：" 第二)
  (打印 "第三个：" 第三))

; ================================
; 管道操作符
; ================================

(打印 "\n=== 管道操作符示例 ===")

; 使用管道操作符进行链式计算
(-> 100
  (/ 10)
  (+ 5)
  (* 2)
  (打印))  ; => 30

; 定义嵌套函数调用
(定义 处理数据
  (过程 (数据)
    (-> 数据
      求和
      (/ 2)
      (+ 10))))

(打印 "处理结果：" (处理数据 '(10 20 30 40)))

; ================================
; Lambda 和高阶函数
; ================================

(打印 "\n=== Lambda 表达式 ===")

; 使用 lambda 创建匿名函数
(定义 映射平方
  (过程 (数值列表)
    (让 ((平方函数 (过程 (x) (* x x))))
      (map 平方函数 数值列表))))

(打印 "平方列表：" (映射平方 '(1 2 3 4 5)))

; 使用 filter 过滤
(定义 过滤偶数
  (过程 (数值列表)
    (让 ((偶数? (过程 (n) (= (mod n 2) 0))))
      (filter 偶数? 数值列表))))

(打印 "偶数列表：" (过滤偶数 '(1 2 3 4 5 6 7 8 9 10)))

; ================================
; 递归函数
; ================================

(打印 "\n=== 递归函数示例 ===")

; 阶乘函数
(定义 阶乘
  (过程 (n)
    (如果 (<= n 1)
      1
      (* n (阶乘 (- n 1))))))

(打印 "5 的阶乘：" (阶乘 5))

; 斐波那契数列
(定义 斐波那契
  (过程 (n)
    (如果 (<= n 1)
      n
      (+ (斐波那契 (- n 1)) (斐波那契 (- n 2))))))

(打印 "第 10 个斐波那契数：" (斐波那契 10))

; ================================
; 实用函数
; ================================

(打印 "\n=== 实用函数 ===")

; 判断偶数
(定义 偶数?
  (过程 (n)
    (= (mod n 2) 0)))

(打印 "10 是偶数？" (偶数? 10))
(打印 "7 是偶数？" (偶数? 7))

; ================================
; 列表操作
; ================================

(打印 "\n=== 列表操作 ===")

; 创建列表
(定义 列表1 '(1 2 3 4 5))
(定义 列表2 '(6 7 8 9 10))

; 列表连接
(定义 合并列表 (append 列表1 列表2))
(打印 "合并列表：" 合并列表)

; ================================
; 中文编程最佳实践示例
; ================================

(打印 "\n=== 最佳实践示例 ===")

; 示例：计算购物车总价
(定义 商品价格
  '(("苹果" . 5.5)
    ("香蕉" . 3.2)
    ("橙子" . 4.8)))

(定义 计算总价
  (过程 (购物车)
    (apply + (map (过程 (商品) (cdr 商品)) 购物车))))

(打印 "购物车总价：" (计算总价 商品价格))

; ================================
; 结束
; ================================

(打印 "\n=== 演示完成 ===")
(打印 "Xisp 支持完整的中文编程！")
(打印 "")
(打印 "💡 提示：")
(打印 "  1. 在 REPL 中输入 ',lang zh' 启用中文关键字")
(打印 "  2. 使用'过程' (procedure) 代替 lambda，避免混淆")
(print "  3. 随时可以切换回英文：',lang en'")
